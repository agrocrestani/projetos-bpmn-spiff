<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:spiffworkflow="http://spiffworkflow.org/bpmn/schema/1.0/core" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_96f6665" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.0.0-dev">
  <bpmn:process id="Process_cadastro_de_parceiro_de_negocio_pj_qqtz0ek" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_17db3yp</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_17db3yp" sourceRef="StartEvent_1" targetRef="Activity_0qpzdpu" />
    <bpmn:endEvent id="EndEvent_1">
      <bpmn:incoming>Flow_1ozlsyd</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_12pkbxb" sourceRef="Activity_0qpzdpu" targetRef="Activity_1mr06y8" />
    <bpmn:userTask id="Activity_0qpzdpu" name="Solicitar Cadastro">
      <bpmn:extensionElements>
        <spiffworkflow:instructionsForEndUser>## Cadastro de Parceiro de Negócio - PJ
Neste processo você vai iniciar o cadastro de um Novo Parceiro de Negócios no ERP da Crestani. O cadastro será analisado pelo departamento responsável e sendo aprovado será inserido no ERP.</spiffworkflow:instructionsForEndUser>
        <spiffworkflow:properties>
          <spiffworkflow:property name="formJsonSchemaFilename" value="cadastro-pn-pj-schema.json" />
          <spiffworkflow:property name="formUiSchemaFilename" value="cadastro-pn-pj-uischema.json" />
        </spiffworkflow:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_17db3yp</bpmn:incoming>
      <bpmn:outgoing>Flow_12pkbxb</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_13oahru" sourceRef="Activity_1mr06y8" targetRef="Activity_16qlavn" />
    <bpmn:serviceTask id="Activity_1mr06y8" name="Busca dados ReceitaWs">
      <bpmn:extensionElements>
        <spiffworkflow:serviceTaskOperator id="http/GetRequestV2" resultVariable="rsp">
          <spiffworkflow:parameters>
            <spiffworkflow:parameter id="url" type="str" value="url" />
            <spiffworkflow:parameter id="headers" type="any" />
            <spiffworkflow:parameter id="params" type="any" />
            <spiffworkflow:parameter id="basic_auth_username" type="str" />
            <spiffworkflow:parameter id="basic_auth_password" type="str" />
            <spiffworkflow:parameter id="verify" type="bool" />
            <spiffworkflow:parameter id="attempts" type="int" />
          </spiffworkflow:parameters>
        </spiffworkflow:serviceTaskOperator>
        <spiffworkflow:instructionsForEndUser />
        <spiffworkflow:preScript>url = 'https://receitaws.com.br/v1/cnpj/'+cnpj</spiffworkflow:preScript>
        <spiffworkflow:postScript>pn = rsp['body']</spiffworkflow:postScript>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_12pkbxb</bpmn:incoming>
      <bpmn:outgoing>Flow_13oahru</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1ozlsyd" sourceRef="Activity_16qlavn" targetRef="EndEvent_1" />
    <bpmn:manualTask id="Activity_16qlavn" name="Verificar Solicitação">
      <bpmn:extensionElements>
        <spiffworkflow:instructionsForEndUser>| Campo      | Conteúdo                  ||
| -------------: | :------------ | ------------- | 
|**CNPJ**  | {{pn['cnpj']}}|
|**Nome**:| {{pn['nome']}}|
|**Fantasia**:| {{pn['fantasia']}}|
|**Abertura**:| {{pn['abertura']}}|
|**Atividade Principal**:| {{atividade_principal}}|
|**Atividades Secundarias**:| {{atividades_secundarias}}|
|**Natureza Juridica**:| {{pn['natureza_juridica']}}|
|**Endereço**:| {{pn['logradouro']}}|
|**Número**:| {{pn['numero']}}|
|**Complemento**:| {{pn['complemento']}}|
|**Bairro**:| {{pn['bairro']}}|
|**CEP**:| {{pn['cep']}}|
|**Municipio**:| {{pn['municipio']}}| **UF**: {{pn['uf']}}|
|**UF**:| {{pn['uf']}}|
|**E-mail**:| {{pn['email']}}|
|**Telefone**:| {{pn['telefone']}}|
|**situacao**:| {{pn['situacao']}}|
|**Data Situação**:| {{pn['data_situacao']}}|
|**Motivo Situacao**:| {{pn['motivo_situacao']}}|
|**Situação Especial**:| {{pn['situacao_especial']}}|
|**Data Situacao Especial**:| {{pn['data_situacao_especial']}}|
|**Capital Social**:| {{pn['capital_social']}}|
</spiffworkflow:instructionsForEndUser>
        <spiffworkflow:preScript>atividade_principal = pn['atividade_principal'][0]['code'] + ' - ' + pn['atividade_principal'][0]['text']
atividades_secundarias = pn['atividades_secundarias'][0]

data = task.data</spiffworkflow:preScript>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_13oahru</bpmn:incoming>
      <bpmn:outgoing>Flow_1ozlsyd</bpmn:outgoing>
    </bpmn:manualTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_cadastro_de_parceiro_de_negocio_pj_qqtz0ek">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="179" y="159" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_14za570_di" bpmnElement="EndEvent_1">
        <dc:Bounds x="782" y="159" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0wscjka_di" bpmnElement="Activity_0qpzdpu">
        <dc:Bounds x="270" y="137" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1vtjajg_di" bpmnElement="Activity_1mr06y8">
        <dc:Bounds x="440" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1k6x7li_di" bpmnElement="Activity_16qlavn">
        <dc:Bounds x="600" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_17db3yp_di" bpmnElement="Flow_17db3yp">
        <di:waypoint x="215" y="177" />
        <di:waypoint x="270" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_12pkbxb_di" bpmnElement="Flow_12pkbxb">
        <di:waypoint x="370" y="177" />
        <di:waypoint x="440" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_13oahru_di" bpmnElement="Flow_13oahru">
        <di:waypoint x="540" y="177" />
        <di:waypoint x="600" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ozlsyd_di" bpmnElement="Flow_1ozlsyd">
        <di:waypoint x="700" y="177" />
        <di:waypoint x="782" y="177" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
