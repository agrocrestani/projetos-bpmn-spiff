<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:spiffworkflow="http://spiffworkflow.org/bpmn/schema/1.0/core" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_96f6665" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.0.0-dev">
  <bpmn:process id="Process_teste_gateway_or_jg9awad" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_17db3yp</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_17db3yp" sourceRef="StartEvent_1" targetRef="Activity_0qpzdpu" />
    <bpmn:manualTask id="Activity_0qpzdpu" name="Define variaveis">
      <bpmn:extensionElements>
        <spiffworkflow:instructionsForEndUser>### carregaMatriz = {{carregaMatriz }}
### carregaQuerencia = {{carregaQuerencia }}</spiffworkflow:instructionsForEndUser>
        <spiffworkflow:preScript>carregaMatriz = 1
carregaQuerencia = 1

teste = [
  {"f": {
      "value": "5",
      "label": "FAZENDA CURUPAI"
    },
  "BPLId": 1,
  "BPLName": "0109-AGROPECUARIA CRESTANI LTDA",
  "AliasName": "FAZENDA QUERENCIA",
  "solicitante": "emerson.gregorio",
  "carregaMatriz": 0,
  "carregaQuerencia": 1,
  "solicitacao": [
    {
      "insumo": {
        "ItemCode": "022607",
        "ItemName": "CARAVAN",
        "ItmsGrpNam": "FUNGICIDAS",
        "InvntryUom": "LITRO",
        "OnHand": "95,00",
        "WhsCode": "03.FQUE"
      },
      "quantidade": 1
    }
  ],
  "unidade": "3",
  "safra": "23/24",
  "solicitacao_bkp": [
    {
      "insumo": "{\"ItemCode\":\"022607\",\"ItemName\":\"CARAVAN\",\"ItmsGrpNam\":\"FUNGICIDAS\",\"InvntryUom\":\"LITRO\",\"OnHand\":\"95,00\",\"WhsCode\":\"03.FQUE\"}",
      "quantidade": 1
    }
  ],
  "CardCode": "C00113",
  "s": {
    "insumo": {
      "ItemCode": "022607",
      "ItemName": "CARAVAN",
      "ItmsGrpNam": "FUNGICIDAS",
      "InvntryUom": "LITRO",
      "OnHand": "95,00",
      "WhsCode": "03.FQUE"
    },
    "quantidade": 1
  },
  "descricaoFilial": "FAZENDA COLORADO",
  "usuarioEmissorNFe": "emerson.gregorio",
  "SlpCode": 8,
  "OwnerCode": 2,
  "u": {
    "value": "134",
    "label": "134-SOMENTE FISCAL"
  },
  "done": true,
  "mainusage": "95",
  "spiff_instancia": 2319,
  "spiff_tarefa": "a6c58cc4-8f12-4205-b8d9-b3a91f319c96",
  "taskInfo": "a6c58cc4-8f12-4205-b8d9-b3a91f319c96",
  "items": [
    {
      "ItemCode": "022607",
      "Quantity": 1,
      "WarehouseCode": "03.FQUE"
    }
  ],
  "payload": {
    "CardCode": "C00113",
    "BPL_IDAssignedToInvoice": "1",
    "DocumentsOwner": 2,
    "SalesPersonCode": 8,
    "Comments": "Solicitante: emerson.gregorio",
    "U_AC_Spiff_Instancia": 2319,
    "U_AC_Spiff_Tarefa": "a6c58cc4-8f12-4205-b8d9-b3a91f319c96",
    "U_AC_Spiff_Usuario": "emerson.gregorio",
    "DocumentLines": [
      {
        "ItemCode": "022607",
        "Quantity": 1,
        "WarehouseCode": "03.FQUE"
      }
    ],
    "TaxExtension": {
      "MainUsage": "95",
      "Incoterms": "0"
    }
  },
  "loginSap": "d4dd8462-1c59-11ef-8000-0200170121d3",
  "url": "https://172.20.1.9:50000/b1s/v1/Invoices",
  "headers": {
    "Cookie": "B1SESSION=d4dd8462-1c59-11ef-8000-0200170121d3",
    "Content-Type": "application/json"
  },
  "DocEntry": 8141,
  "query": "\n            select \"KeyNfe\", CNPJ from SBO_CRESTANI_PRD.AC_NfeRetorno nf where nf.\"DocEntry\" = 2066 AND nf.\"Tabela\" = 'OINV' \n          ",
  "sqlRsp": [
    {
      "keynfe": "51240103262185000109550010000257321290836637",
      "cnpj": "03262185000109"
    }
  ],
  "chaveAcesso": "51240103262185000109550010000257321290836637",
  "cnpj": "03262185000109",
  "arquivo_nfe": "file://///srv-rds-02/CaminhosSAP/Anexos/NFe/03262185000109/danfe/51240103262185000109550010000257321290836637.pdf",
  "DocNum": 4486,
  "Serial": 27358,
  "DocDate": "2024-05-27T00:00:00Z",
  "CardName": "AGROPECUARIA CRESTANI LTDA",
  "VATRegNum": "03.262.185/0001-09",
  "itens": [
    {
      "LineNum": 0,
      "ItemCode": "022607",
      "ItemDescription": "CARAVAN",
      "Quantity": 1,
      "Price": 97.444,
      "WarehouseCode": "03.FQUE",
      "LineTotal": 97.44
    }
  ],
  "Total": 97.44,
  "i": {
    "LineNum": 0,
    "ItemCode": "022607",
    "ItemDescription": "CARAVAN",
    "Quantity": 1,
    "Price": 97.444,
    "WarehouseCode": "03.FQUE",
    "LineTotal": 97.44
  },
  "itensMatriz": [],
  "itensQuerencia": [
    {
      "LineNum": 0,
      "ItemCode": "022607",
      "ItemDescription": "CARAVAN",
      "Quantity": 1,
      "Price": 97.444,
      "WarehouseCode": "03.FQUE",
      "LineTotal": 97.44
    }
  ],
  "TotalMatriz": 0,
  "TotalQuerencia": 97.44
}
]</spiffworkflow:preScript>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_17db3yp</bpmn:incoming>
      <bpmn:outgoing>Flow_0dnvt7r</bpmn:outgoing>
    </bpmn:manualTask>
    <bpmn:sequenceFlow id="Flow_0dnvt7r" sourceRef="Activity_0qpzdpu" targetRef="Gateway_1ls5xhn" />
    <bpmn:inclusiveGateway id="Gateway_1ls5xhn">
      <bpmn:incoming>Flow_0dnvt7r</bpmn:incoming>
      <bpmn:outgoing>Flow_1m51sal</bpmn:outgoing>
      <bpmn:outgoing>Flow_1rtxn9s</bpmn:outgoing>
    </bpmn:inclusiveGateway>
    <bpmn:sequenceFlow id="Flow_1m51sal" sourceRef="Gateway_1ls5xhn" targetRef="Activity_0mk6h2b">
      <bpmn:conditionExpression>carregaMatriz == 1</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1rtxn9s" sourceRef="Gateway_1ls5xhn" targetRef="Activity_0j9vw6e">
      <bpmn:conditionExpression>carregaQuerencia == 1</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0zni5ev" sourceRef="Activity_0mk6h2b" targetRef="Gateway_0abgvr8" />
    <bpmn:inclusiveGateway id="Gateway_0abgvr8">
      <bpmn:incoming>Flow_0zni5ev</bpmn:incoming>
      <bpmn:incoming>Flow_0p9abao</bpmn:incoming>
      <bpmn:outgoing>Flow_1253ilp</bpmn:outgoing>
    </bpmn:inclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0p9abao" sourceRef="Activity_0j9vw6e" targetRef="Gateway_0abgvr8" />
    <bpmn:endEvent id="Event_1s2nulu">
      <bpmn:incoming>Flow_1253ilp</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1253ilp" sourceRef="Gateway_0abgvr8" targetRef="Event_1s2nulu" />
    <bpmn:userTask id="Activity_0mk6h2b" name="Carrega Matriz">
      <bpmn:extensionElements>
        <spiffworkflow:properties>
          <spiffworkflow:property name="formJsonSchemaFilename" value="carrega-schema.json" />
          <spiffworkflow:property name="formUiSchemaFilename" value="carrega-uischema.json" />
        </spiffworkflow:properties>
        <spiffworkflow:instructionsForEndUser>### carregaMatriz = {{carregaMatriz }}
### carregaQuerencia = {{carregaQuerencia }}</spiffworkflow:instructionsForEndUser>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1m51sal</bpmn:incoming>
      <bpmn:outgoing>Flow_0zni5ev</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Activity_0j9vw6e" name="Carrega Querencia">
      <bpmn:extensionElements>
        <spiffworkflow:properties>
          <spiffworkflow:property name="formJsonSchemaFilename" value="carrega-schema.json" />
        </spiffworkflow:properties>
        <spiffworkflow:instructionsForEndUser>### carregaMatriz = {{carregaMatriz }}
### carregaQuerencia = {{carregaQuerencia }}</spiffworkflow:instructionsForEndUser>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1rtxn9s</bpmn:incoming>
      <bpmn:outgoing>Flow_0p9abao</bpmn:outgoing>
    </bpmn:userTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_teste_gateway_or_jg9awad">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="179" y="159" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0zqotmb_di" bpmnElement="Activity_0qpzdpu">
        <dc:Bounds x="270" y="137" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_17vz534_di" bpmnElement="Gateway_1ls5xhn">
        <dc:Bounds x="425" y="152" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1yhsh0t_di" bpmnElement="Gateway_0abgvr8">
        <dc:Bounds x="685" y="152" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1s2nulu_di" bpmnElement="Event_1s2nulu">
        <dc:Bounds x="792" y="159" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1gof64r_di" bpmnElement="Activity_0mk6h2b">
        <dc:Bounds x="530" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1vv948k_di" bpmnElement="Activity_0j9vw6e">
        <dc:Bounds x="530" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_17db3yp_di" bpmnElement="Flow_17db3yp">
        <di:waypoint x="215" y="177" />
        <di:waypoint x="270" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0dnvt7r_di" bpmnElement="Flow_0dnvt7r">
        <di:waypoint x="370" y="177" />
        <di:waypoint x="425" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1m51sal_di" bpmnElement="Flow_1m51sal">
        <di:waypoint x="475" y="177" />
        <di:waypoint x="530" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1rtxn9s_di" bpmnElement="Flow_1rtxn9s">
        <di:waypoint x="450" y="202" />
        <di:waypoint x="450" y="290" />
        <di:waypoint x="530" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0zni5ev_di" bpmnElement="Flow_0zni5ev">
        <di:waypoint x="630" y="177" />
        <di:waypoint x="685" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0p9abao_di" bpmnElement="Flow_0p9abao">
        <di:waypoint x="630" y="290" />
        <di:waypoint x="710" y="290" />
        <di:waypoint x="710" y="202" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1253ilp_di" bpmnElement="Flow_1253ilp">
        <di:waypoint x="735" y="177" />
        <di:waypoint x="792" y="177" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
